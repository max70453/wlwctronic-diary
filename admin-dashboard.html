<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Панель администратора</title>
    <link rel="stylesheet" href="css/global.css">
    <link rel="stylesheet" href="css/footer.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@mui/icons-material@5.11.0/fonts/index.css" />
    <style>
        /* Header стили */
        .app-bar {
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .MuiAppBar-root {
            background: linear-gradient(90deg, #3f51b5 0%, #303f9f 100%);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .MuiToolbar-root {
            min-height: 64px;
            padding: 0 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            text-decoration: none;
            color: white;
            font-size: 1.2rem;
            font-weight: 500;
        }

        .logo-icon {
            font-size: 2rem;
            margin-right: 10px;
            color: #ffd700;
        }

        .nav-link {
            color: white;
            text-decoration: none;
            padding: 8px 16px;
            border-radius: 4px;
            transition: background 0.3s ease;
        }

        .nav-link:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .logout-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            transition: background 0.3s ease;
        }

        .logout-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        /* Основные стили */
        body {
            margin: 0;
            font-family: 'Roboto', sans-serif;
            background-color: #f5f5f5;
        }

        .admin-dashboard-container {
            padding: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }

        .MuiPaper-root {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-bottom: 24px;
            padding: 24px;
        }

        .MuiTypography-h5 {
            font-size: 1.5rem;
            font-weight: 500;
            margin: 0 0 20px 0;
            color: #333;
        }

        /* Tabs стили */
        .MuiTabs-root {
            border-bottom: 2px solid #e0e0e0;
            margin-bottom: 24px;
        }

        .MuiTabs-flexContainer {
            display: flex;
            gap: 8px;
        }

        .MuiTab-root {
            padding: 12px 16px;
            border: none;
            background: none;
            cursor: pointer;
            border-radius: 8px 8px 0 0;
            font-weight: 500;
            color: #666;
            transition: all 0.3s ease;
        }

        .MuiTab-root:hover {
            background: rgba(63, 81, 181, 0.05);
        }

        .MuiTab-root.Mui-selected {
            color: #3f51b5;
            background: #3f51b5;
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        /* Таблицы */
        .users-table, .classes-table, .schedule-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 16px;
        }

        .users-table th, .users-table td,
        .classes-table th, .classes-table td,
        .schedule-table th, .schedule-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }

        .users-table th, .classes-table th, .schedule-table th {
            background-color: #f8f9fa;
            font-weight: 500;
            color: #333;
        }

        .users-table tr:hover, .classes-table tr:hover, .schedule-table tr:hover {
            background-color: #f8f9fa;
        }

        /* Кнопки */
        .MuiButton-root {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            margin: 0 4px;
        }

        .MuiButton-contained {
            background: #3f51b5;
            color: white;
        }

        .MuiButton-contained:hover {
            background: #303f9f;
        }

        .MuiButton-outlined {
            background: transparent;
            border: 1px solid #3f51b5;
            color: #3f51b5;
        }

        .MuiButton-outlined:hover {
            background: rgba(63, 81, 181, 0.05);
        }

        /* Формы */
        .form-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 24px;
            padding: 16px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            margin-bottom: 4px;
        }

        .form-group label {
            margin-bottom: 8px;
            font-weight: 500;
            color: #333;
            font-size: 0.9rem;
        }

        .form-control {
            padding: 12px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: white;
            box-sizing: border-box;
            width: 100%;
        }

        .form-control:focus {
            outline: none;
            border-color: #3f51b5;
            box-shadow: 0 0 0 3px rgba(63, 81, 181, 0.1);
        }

        .form-control::placeholder {
            color: #999;
            font-style: italic;
        }

        /* Статистика */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        /* Настройки */
        .settings-section {
            margin-bottom: 32px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
        }

        .settings-section h4 {
            margin-bottom: 20px;
            color: #333;
            font-size: 1.1rem;
            font-weight: 500;
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            border-bottom: 1px solid #e0e0e0;
        }

        .setting-item:last-child {
            border-bottom: none;
        }

        .setting-item .form-control {
            width: auto;
            min-width: 120px;
            margin-left: 16px;
        }

        .toggle-switch {
            position: relative;
            width: 50px;
            height: 24px;
            background: #ccc;
            border-radius: 12px;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .toggle-switch.active {
            background: #4caf50;
        }

        .toggle-switch::after {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            top: 2px;
            left: 2px;
            transition: transform 0.3s ease;
        }

        .toggle-switch.active::after {
            transform: translateX(26px);
        }

        /* Footer */
        .footer {
            background-color: #1e283c;
            color: white;
            padding: 40px 20px 20px;
            text-align: center;
            margin-top: 60px;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
        }

        .footer-section h4 {
            font-size: 1.2rem;
            margin-bottom: 20px;
            color: white;
        }

        .footer-section p, .footer-section a {
            color: #ccc;
            text-decoration: none;
            margin-bottom: 10px;
            display: block;
            font-size: 0.9rem;
        }

        .footer-section a:hover {
            color: white;
        }

        .footer-bottom {
            border-top: 1px solid #333;
            margin-top: 30px;
            padding-top: 20px;
            font-size: 0.9rem;
            color: #999;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @media (max-width: 768px) {
            .admin-dashboard-container {
                padding: 10px;
            }

            .MuiTabs-flexContainer {
                flex-direction: column;
            }

            .form-container {
                grid-template-columns: 1fr;
                gap: 16px;
                padding: 12px;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .setting-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 12px;
            }

            .setting-item .form-control {
                width: 100%;
                margin-left: 0;
            }
        }
    </style>
</head>
<body>
    <!-- Material-UI AppBar -->
    <div id="app-bar"></div>

    <main>
        <div class="admin-dashboard-container">
            <!-- Статистика системы -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="total-users">0</div>
                    <div class="stat-label">Всего пользователей</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="total-students">0</div>
                    <div class="stat-label">Учеников</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="total-teachers">0</div>
                    <div class="stat-label">Учителей</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="total-classes">0</div>
                    <div class="stat-label">Классов</div>
                </div>
            </div>

            <!-- Управление пользователями -->
            <div class="MuiPaper-root">
                <h3 class="MuiTypography-h5">Управление пользователями</h3>

                <!-- Material-UI Tabs -->
                <div class="MuiTabs-root">
                    <div class="MuiTabs-flexContainer">
                        <button class="MuiTab-root Mui-selected" data-tab="students">
                            <span class="MuiTab-wrapper">Ученики</span>
                        </button>
                        <button class="MuiTab-root" data-tab="teachers">
                            <span class="MuiTab-wrapper">Учителя</span>
                        </button>
                        <button class="MuiTab-root" data-tab="parents">
                            <span class="MuiTab-wrapper">Родители</span>
                        </button>
                        <button class="MuiTab-root" data-tab="admins">
                            <span class="MuiTab-wrapper">Администраторы</span>
                        </button>
                    </div>
                </div>

                <!-- Форма добавления пользователя -->
                <div class="form-container" id="user-form-container">
                    <div class="form-group">
                        <label for="user-firstname">Имя:</label>
                        <input type="text" id="user-firstname" class="form-control" placeholder="Введите имя">
                    </div>
                    <div class="form-group">
                        <label for="user-lastname">Фамилия:</label>
                        <input type="text" id="user-lastname" class="form-control" placeholder="Введите фамилию">
                    </div>
                    <div class="form-group">
                        <label for="user-email">Email:</label>
                        <input type="email" id="user-email" class="form-control" placeholder="Введите email">
                    </div>
                    <div class="form-group">
                        <label for="user-phone">Телефон:</label>
                        <input type="tel" id="user-phone" class="form-control" placeholder="Введите телефон">
                    </div>
                    <div class="form-group">
                        <label for="user-class">Класс (для учеников):</label>
                        <select id="user-class" class="form-control">
                            <option value="">Выберите класс</option>
                            <option value="1А">1А</option>
                            <option value="1Б">1Б</option>
                            <option value="2А">2А</option>
                            <option value="2Б">2Б</option>
                            <option value="3А">3А</option>
                            <option value="3Б">3Б</option>
                            <option value="4А">4А</option>
                            <option value="4Б">4Б</option>
                            <option value="5А">5А</option>
                            <option value="5Б">5Б</option>
                            <option value="6А">6А</option>
                            <option value="6Б">6Б</option>
                            <option value="7А">7А</option>
                            <option value="7Б">7Б</option>
                            <option value="8А">8А</option>
                            <option value="8Б">8Б</option>
                            <option value="9А">9А</option>
                            <option value="9Б">9Б</option>
                            <option value="10А">10А</option>
                            <option value="10Б">10Б</option>
                            <option value="11А">11А</option>
                            <option value="11Б">11Б</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="user-subjects">Предметы (для учителей):</label>
                        <input type="text" id="user-subjects" class="form-control" placeholder="Введите предметы через запятую">
                    </div>
                    <div class="form-group" style="grid-column: 1 / -1;">
                        <button class="MuiButton-root MuiButton-contained" onclick="addUser()" style="width: 100%; padding: 14px 20px; font-size: 1rem;">
                            <i class="material-icons" style="font-size: 1.2rem; vertical-align: middle; margin-right: 8px;">add</i>
                            Добавить пользователя
                        </button>
                    </div>
                </div>

                <!-- Таблицы пользователей -->
                <div id="students-tab" class="tab-content active">
                    <table class="users-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>ФИО</th>
                                <th>Класс</th>
                                <th>Email</th>
                                <th>Телефон</th>
                                <th>Действия</th>
                            </tr>
                        </thead>
                        <tbody id="students-table-body">
                            <!-- Данные будут загружены через JS -->
                        </tbody>
                    </table>
                </div>
                <div id="teachers-tab" class="tab-content">
                    <table class="users-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>ФИО</th>
                                <th>Предметы</th>
                                <th>Email</th>
                                <th>Телефон</th>
                                <th>Действия</th>
                            </tr>
                        </thead>
                        <tbody id="teachers-table-body">
                            <!-- Данные будут загружены через JS -->
                        </tbody>
                    </table>
                </div>
                <div id="parents-tab" class="tab-content">
                    <table class="users-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>ФИО</th>
                                <th>Дети</th>
                                <th>Email</th>
                                <th>Телефон</th>
                                <th>Действия</th>
                            </tr>
                        </thead>
                        <tbody id="parents-table-body">
                            <!-- Данные будут загружены через JS -->
                        </tbody>
                    </table>
                </div>
                <div id="admins-tab" class="tab-content">
                    <table class="users-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>ФИО</th>
                                <th>Email</th>
                                <th>Телефон</th>
                                <th>Роль</th>
                                <th>Действия</th>
                            </tr>
                        </thead>
                        <tbody id="admins-table-body">
                            <!-- Данные будут загружены через JS -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Управление классами -->
            <div class="MuiPaper-root">
                <h3 class="MuiTypography-h5">Управление классами</h3>
                
                <div class="form-container">
                    <div class="form-group">
                        <label for="class-name">Название класса:</label>
                        <input type="text" id="class-name" class="form-control" placeholder="Например: 5А">
                    </div>
                    <div class="form-group">
                        <label for="class-teacher">Классный руководитель:</label>
                        <select id="class-teacher" class="form-control">
                            <option value="">Выберите учителя</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="class-room">Кабинет:</label>
                        <input type="text" id="class-room" class="form-control" placeholder="Например: 205">
                    </div>
                    <div class="form-group" style="grid-column: 1 / -1;">
                        <button class="MuiButton-root MuiButton-contained" onclick="addClass()" style="width: 100%; padding: 14px 20px; font-size: 1rem;">
                            <i class="material-icons" style="font-size: 1.2rem; vertical-align: middle; margin-right: 8px;">add</i>
                            Добавить класс
                        </button>
                    </div>
                </div>

                <div id="classes-management">
                    <table class="classes-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Название</th>
                                <th>Классный руководитель</th>
                                <th>Кабинет</th>
                                <th>Количество учеников</th>
                                <th>Действия</th>
                            </tr>
                        </thead>
                        <tbody id="classes-table-body">
                            <!-- Данные будут загружены через JS -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Управление расписанием -->
            <div class="MuiPaper-root">
                <h3 class="MuiTypography-h5">Управление расписанием</h3>
                
                <div class="form-container">
                    <div class="form-group">
                        <label for="schedule-class">Класс:</label>
                        <select id="schedule-class" class="form-control">
                            <option value="">Выберите класс</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="schedule-day">День недели:</label>
                        <select id="schedule-day" class="form-control">
                            <option value="">Выберите день</option>
                            <option value="Понедельник">Понедельник</option>
                            <option value="Вторник">Вторник</option>
                            <option value="Среда">Среда</option>
                            <option value="Четверг">Четверг</option>
                            <option value="Пятница">Пятница</option>
                            <option value="Суббота">Суббота</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="schedule-time">Время:</label>
                        <input type="text" id="schedule-time" class="form-control" placeholder="Например: 9:00-10:30">
                    </div>
                    <div class="form-group">
                        <label for="schedule-subject">Предмет:</label>
                        <input type="text" id="schedule-subject" class="form-control" placeholder="Например: Математика">
                    </div>
                    <div class="form-group">
                        <label for="schedule-teacher">Учитель:</label>
                        <select id="schedule-teacher" class="form-control">
                            <option value="">Выберите учителя</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="schedule-room">Кабинет:</label>
                        <input type="text" id="schedule-room" class="form-control" placeholder="Например: 205">
                    </div>
                    <div class="form-group" style="grid-column: 1 / -1;">
                        <button class="MuiButton-root MuiButton-contained" onclick="addScheduleItem()" style="width: 100%; padding: 14px 20px; font-size: 1rem;">
                            <i class="material-icons" style="font-size: 1.2rem; vertical-align: middle; margin-right: 8px;">add</i>
                            Добавить в расписание
                        </button>
                    </div>
                </div>

                <div id="schedule-management">
                    <table class="schedule-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Класс</th>
                                <th>День недели</th>
                                <th>Время</th>
                                <th>Предмет</th>
                                <th>Учитель</th>
                                <th>Кабинет</th>
                                <th>Действия</th>
                            </tr>
                        </thead>
                        <tbody id="schedule-table-body">
                            <!-- Данные будут загружены через JS -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Настройки системы -->
            <div class="MuiPaper-root">
                <h3 class="MuiTypography-h5">Настройки системы</h3>
                
                <div class="settings-section">
                    <h4>Общие настройки</h4>
                    <div class="setting-item">
                        <div>
                            <strong>Регистрация новых пользователей</strong>
                            <p style="margin: 5px 0; color: #666; font-size: 0.9rem;">Разрешить регистрацию новых пользователей в системе</p>
                        </div>
                        <div class="toggle-switch" id="registration-toggle" onclick="toggleSetting('registration')"></div>
                    </div>
                    <div class="setting-item">
                        <div>
                            <strong>Email-уведомления</strong>
                            <p style="margin: 5px 0; color: #666; font-size: 0.9rem;">Отправлять email-уведомления о важных событиях</p>
                        </div>
                        <div class="toggle-switch active" id="email-notifications-toggle" onclick="toggleSetting('emailNotifications')"></div>
                    </div>
                    <div class="setting-item">
                        <div>
                            <strong>Автоматическое резервное копирование</strong>
                            <p style="margin: 5px 0; color: #666; font-size: 0.9rem;">Создавать резервные копии данных автоматически</p>
                        </div>
                        <div class="toggle-switch active" id="backup-toggle" onclick="toggleSetting('backup')"></div>
                    </div>
                </div>

                <div class="settings-section">
                    <h4>Настройки оценок</h4>
                    <div class="setting-item">
                        <div>
                            <strong>Минимальная оценка</strong>
                            <p style="margin: 5px 0; color: #666; font-size: 0.9rem;">Минимально возможная оценка в системе</p>
                        </div>
                        <input type="number" id="min-grade" class="form-control" style="width: 100px;" value="2" min="1" max="5">
                    </div>
                    <div class="setting-item">
                        <div>
                            <strong>Максимальная оценка</strong>
                            <p style="margin: 5px 0; color: #666; font-size: 0.9rem;">Максимально возможная оценка в системе</p>
                        </div>
                        <input type="number" id="max-grade" class="form-control" style="width: 100px;" value="5" min="1" max="10">
                    </div>
                </div>

                <div class="settings-section">
                    <h4>Настройки расписания</h4>
                    <div class="setting-item">
                        <div>
                            <strong>Начало учебного дня</strong>
                            <p style="margin: 5px 0; color: #666; font-size: 0.9rem;">Время начала учебных занятий</p>
                        </div>
                        <input type="time" id="school-start-time" class="form-control" style="width: 150px;" value="08:30">
                    </div>
                    <div class="setting-item">
                        <div>
                            <strong>Конец учебного дня</strong>
                            <p style="margin: 5px 0; color: #666; font-size: 0.9rem;">Время окончания учебных занятий</p>
                        </div>
                        <input type="time" id="school-end-time" class="form-control" style="width: 150px;" value="15:00">
                    </div>
                    <div class="setting-item">
                        <div>
                            <strong>Длительность урока (минут)</strong>
                            <p style="margin: 5px 0; color: #666; font-size: 0.9rem;">Стандартная длительность одного урока</p>
                        </div>
                        <input type="number" id="lesson-duration" class="form-control" style="width: 100px;" value="45" min="30" max="90">
                    </div>
                </div>

                <div class="form-group" style="grid-column: 1 / -1;">
                    <button class="MuiButton-root MuiButton-contained" onclick="saveSettings()" style="width: 100%; padding: 14px 20px; font-size: 1rem;">
                        <i class="material-icons" style="font-size: 1.2rem; vertical-align: middle; margin-right: 8px;">save</i>
                        Сохранить настройки
                    </button>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section">
                <h4>E-Journal</h4>
                <p>Инновационная платформа для управления учебным процессом</p>
            </div>
            <div class="footer-section">
                <h4>Ссылки</h4>
                <a href="index.html">Главная</a>
                <a href="#">О платформе</a>
                <a href="#">Поддержка</a>
                <a href="#">Контакты</a>
            </div>
            <div class="footer-section">
                <h4>Контакты</h4>
                <p><i class="material-icons" style="font-size: 1rem; vertical-align: middle;">email</i> info@E-Journal.ru</p>
                <p><i class="material-icons" style="font-size: 1rem; vertical-align: middle;">phone</i> +7 (123) 456-78-90</p>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2026 E-Journal. Все права защищены.</p>
        </div>
    </footer>

    <script src="js/api.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/admin-dashboard.js"></script>
    <script>
        // Инициализация AppBar с улучшенным дизайном
        document.addEventListener('DOMContentLoaded', function() {
            const appBar = document.getElementById('app-bar');
            const adminId = localStorage.getItem('adminId') || 'admin1';

            appBar.className = 'app-bar';
            appBar.innerHTML = `
                <div class="MuiAppBar-root MuiAppBar-positionStatic" style="background: linear-gradient(90deg, #3f51b5 0%, #303f9f 100%);">
                    <div class="MuiToolbar-root MuiToolbar-regular" style="min-height: 64px; padding: 0 24px; display: flex; justify-content: space-between; align-items: center;">
                        <a href="index.html" class="logo">
                            <i class="material-icons logo-icon">admin_panel_settings</i>
                            <span>
                                <strong>E-Journal Admin</strong><br>
                                <small style="font-size: 0.8rem; opacity: 0.8;">Панель администратора</small>
                            </span>
                        </a>
                        <div style="display: flex; gap: 10px;">
                            <a href="index.html" class="nav-link">Главная</a>
                            <button class="logout-btn" onclick="logout()">
                                <i class="material-icons" style="font-size: 1rem; vertical-align: middle; margin-right: 5px;">logout</i>
                                Выйти
                            </button>
                        </div>
                    </div>
                </div>
            `;

            // Загружаем данные администратора
            loadAdminDashboard(adminId);

            // Инициализация вкладок
            initializeTabs();
        });

        // Инициализация вкладок
        function initializeTabs() {
            const tabButtons = document.querySelectorAll('.MuiTab-root');
            const tabContents = document.querySelectorAll('.tab-content');

            tabButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const targetTab = this.getAttribute('data-tab');

                    // Удаляем активный класс у всех кнопок
                    tabButtons.forEach(btn => btn.classList.remove('Mui-selected'));
                    // Добавляем активный класс текущей кнопке
                    this.classList.add('Mui-selected');

                    // Скрываем все вкладки
                    tabContents.forEach(content => content.classList.remove('active'));
                    // Показываем выбранную вкладку
                    const targetContent = document.getElementById(targetTab + '-tab');
                    if (targetContent) {
                        targetContent.classList.add('active');
                    }
                });
            });
        }

        // Основная функция загрузки дашборда
        function loadAdminDashboard(adminId) {
            console.log('=== ЗАГРУЗКА ДАШБОРДА АДМИНИСТРАТОРА ===');
            
            // Инициализируем данные если их нет
            initializeAdminData();
            
            // Загружаем статистику
            loadStatistics();
            
            // Загружаем пользователей
            loadUsers();
            
            // Загружаем классы
            loadClasses();
            
            // Загружаем расписание
            loadSchedule();
            
            // Загружаем настройки
            loadSettings();
        }

        // Инициализация данных администратора
        function initializeAdminData() {
            if (!localStorage.getItem('adminData')) {
                const adminData = {
                    id: 'admin1',
                    name: 'Администратор Системы',
                    email: 'admin@e-journal.ru',
                    phone: '+7 (123) 456-78-90',
                    role: 'admin'
                };
                localStorage.setItem('adminData', JSON.stringify(adminData));
            }

            // Инициализация пользователей если их нет
            if (!localStorage.getItem('usersData')) {
                const usersData = {
                    students: [
                        { id: 'student1', firstName: 'Иван', lastName: 'Петров', class: '5А', email: 'ivan.petrov@school.ru', phone: '+7 (900) 123-45-67' },
                        { id: 'student2', firstName: 'Мария', lastName: 'Иванова', class: '5А', email: 'maria.ivanova@school.ru', phone: '+7 (900) 234-56-78' },
                        { id: 'student3', firstName: 'Алексей', lastName: 'Сидоров', class: '5Б', email: 'alexey.sidorov@school.ru', phone: '+7 (900) 345-67-89' }
                    ],
                    teachers: [
                        { id: 'teacher1', firstName: 'Анна', lastName: 'Смирнова', subjects: 'Математика, Алгебра', email: 'anna.smirnova@school.ru', phone: '+7 (900) 456-78-90' },
                        { id: 'teacher2', firstName: 'Петр', lastName: 'Волков', subjects: 'Русский язык, Литература', email: 'petr.volkov@school.ru', phone: '+7 (900) 567-89-01' }
                    ],
                    parents: [
                        { id: 'parent1', firstName: 'Ольга', lastName: 'Петрова', children: 'Иван Петров (5А)', email: 'olga.petrova@mail.ru', phone: '+7 (900) 678-90-12' },
                        { id: 'parent2', firstName: 'Сергей', lastName: 'Иванов', children: 'Мария Иванова (5А)', email: 'sergey.ivanov@mail.ru', phone: '+7 (900) 789-01-23' }
                    ],
                    admins: [
                        { id: 'admin1', firstName: 'Администратор', lastName: 'Системы', email: 'admin@e-journal.ru', phone: '+7 (123) 456-78-90', role: 'Супер-администратор' }
                    ]
                };
                localStorage.setItem('usersData', JSON.stringify(usersData));
            }

            // Инициализация классов если их нет
            if (!localStorage.getItem('classesData')) {
                const classesData = [
                    { id: 'class1', name: '5А', teacher: 'Анна Смирнова', room: '205', students: 25 },
                    { id: 'class2', name: '5Б', teacher: 'Петр Волков', room: '206', students: 23 },
                    { id: 'class3', name: '6А', teacher: 'Анна Смирнова', room: '305', students: 24 }
                ];
                localStorage.setItem('classesData', JSON.stringify(classesData));
            }

            // Инициализация расписания если его нет
            if (!localStorage.getItem('scheduleData')) {
                const scheduleData = [
                    { id: 'schedule1', class: '5А', day: 'Понедельник', time: '9:00-10:30', subject: 'Математика', teacher: 'Анна Смирнова', room: '205' },
                    { id: 'schedule2', class: '5А', day: 'Понедельник', time: '10:45-12:15', subject: 'Русский язык', teacher: 'Петр Волков', room: '206' },
                    { id: 'schedule3', class: '5Б', day: 'Понедельник', time: '9:00-10:30', subject: 'Русский язык', teacher: 'Петр Волков', room: '206' }
                ];
                localStorage.setItem('scheduleData', JSON.stringify(scheduleData));
            }

            // Инициализация настроек если их нет
            if (!localStorage.getItem('systemSettings')) {
                const systemSettings = {
                    registration: false,
                    emailNotifications: true,
                    backup: true,
                    minGrade: 2,
                    maxGrade: 5,
                    schoolStartTime: '08:30',
                    schoolEndTime: '15:00',
                    lessonDuration: 45
                };
                localStorage.setItem('systemSettings', JSON.stringify(systemSettings));
            }
        }

        // Загрузка статистики
        function loadStatistics() {
            const usersData = JSON.parse(localStorage.getItem('usersData') || '{}');
            const classesData = JSON.parse(localStorage.getItem('classesData') || '[]');
            
            const totalUsers = (usersData.students?.length || 0) + (usersData.teachers?.length || 0) + (usersData.parents?.length || 0) + (usersData.admins?.length || 0);
            const totalStudents = usersData.students?.length || 0;
            const totalTeachers = usersData.teachers?.length || 0;
            const totalClasses = classesData.length;
            
            document.getElementById('total-users').textContent = totalUsers;
            document.getElementById('total-students').textContent = totalStudents;
            document.getElementById('total-teachers').textContent = totalTeachers;
            document.getElementById('total-classes').textContent = totalClasses;
        }

        // Загрузка пользователей
        function loadUsers() {
            const usersData = JSON.parse(localStorage.getItem('usersData') || '{}');
            
            // Загрузка учеников
            const studentsTable = document.getElementById('students-table-body');
            if (studentsTable && usersData.students) {
                studentsTable.innerHTML = usersData.students.map(student => `
                    <tr>
                        <td>${student.id}</td>
                        <td>${student.lastName} ${student.firstName}</td>
                        <td>${student.class}</td>
                        <td>${student.email}</td>
                        <td>${student.phone}</td>
                        <td>
                            <button class="MuiButton-root MuiButton-outlined" onclick="editUser('student', '${student.id}')">
                                <i class="material-icons" style="font-size: 1rem; vertical-align: middle;">edit</i>
                            </button>
                            <button class="MuiButton-root MuiButton-outlined" style="color: #f44336; border-color: #f44336;" onclick="deleteUser('student', '${student.id}')">
                                <i class="material-icons" style="font-size: 1rem; vertical-align: middle;">delete</i>
                            </button>
                        </td>
                    </tr>
                `).join('');
            }
            
            // Загрузка учителей
            const teachersTable = document.getElementById('teachers-table-body');
            if (teachersTable && usersData.teachers) {
                teachersTable.innerHTML = usersData.teachers.map(teacher => `
                    <tr>
                        <td>${teacher.id}</td>
                        <td>${teacher.lastName} ${teacher.firstName}</td>
                        <td>${teacher.subjects}</td>
                        <td>${teacher.email}</td>
                        <td>${teacher.phone}</td>
                        <td>
                            <button class="MuiButton-root MuiButton-outlined" onclick="editUser('teacher', '${teacher.id}')">
                                <i class="material-icons" style="font-size: 1rem; vertical-align: middle;">edit</i>
                            </button>
                            <button class="MuiButton-root MuiButton-outlined" style="color: #f44336; border-color: #f44336;" onclick="deleteUser('teacher', '${teacher.id}')">
                                <i class="material-icons" style="font-size: 1rem; vertical-align: middle;">delete</i>
                            </button>
                        </td>
                    </tr>
                `).join('');
            }
            
            // Загрузка родителей
            const parentsTable = document.getElementById('parents-table-body');
            if (parentsTable && usersData.parents) {
                parentsTable.innerHTML = usersData.parents.map(parent => `
                    <tr>
                        <td>${parent.id}</td>
                        <td>${parent.lastName} ${parent.firstName}</td>
                        <td>${parent.children}</td>
                        <td>${parent.email}</td>
                        <td>${parent.phone}</td>
                        <td>
                            <button class="MuiButton-root MuiButton-outlined" onclick="editUser('parent', '${parent.id}')">
                                <i class="material-icons" style="font-size: 1rem; vertical-align: middle;">edit</i>
                            </button>
                            <button class="MuiButton-root MuiButton-outlined" style="color: #f44336; border-color: #f44336;" onclick="deleteUser('parent', '${parent.id}')">
                                <i class="material-icons" style="font-size: 1rem; vertical-align: middle;">delete</i>
                            </button>
                        </td>
                    </tr>
                `).join('');
            }
            
            // Загрузка администраторов
            const adminsTable = document.getElementById('admins-table-body');
            if (adminsTable && usersData.admins) {
                adminsTable.innerHTML = usersData.admins.map(admin => `
                    <tr>
                        <td>${admin.id}</td>
                        <td>${admin.lastName} ${admin.firstName}</td>
                        <td>${admin.email}</td>
                        <td>${admin.phone}</td>
                        <td>${admin.role}</td>
                        <td>
                            <button class="MuiButton-root MuiButton-outlined" onclick="editUser('admin', '${admin.id}')">
                                <i class="material-icons" style="font-size: 1rem; vertical-align: middle;">edit</i>
                            </button>
                            <button class="MuiButton-root MuiButton-outlined" style="color: #f44336; border-color: #f44336;" onclick="deleteUser('admin', '${admin.id}')">
                                <i class="material-icons" style="font-size: 1rem; vertical-align: middle;">delete</i>
                            </button>
                        </td>
                    </tr>
                `).join('');
            }
        }

        // Загрузка классов
        function loadClasses() {
            const classesData = JSON.parse(localStorage.getItem('classesData') || '[]');
            const classesTable = document.getElementById('classes-table-body');
            
            if (classesTable) {
                classesTable.innerHTML = classesData.map(cls => `
                    <tr>
                        <td>${cls.id}</td>
                        <td>${cls.name}</td>
                        <td>${cls.teacher}</td>
                        <td>${cls.room}</td>
                        <td>${cls.students}</td>
                        <td>
                            <button class="MuiButton-root MuiButton-outlined" onclick="editClass('${cls.id}')">
                                <i class="material-icons" style="font-size: 1rem; vertical-align: middle;">edit</i>
                            </button>
                            <button class="MuiButton-root MuiButton-outlined" style="color: #f44336; border-color: #f44336;" onclick="deleteClass('${cls.id}')">
                                <i class="material-icons" style="font-size: 1rem; vertical-align: middle;">delete</i>
                            </button>
                        </td>
                    </tr>
                `).join('');
            }
            
            // Обновляем селекторы
            updateClassSelectors();
        }

        // Загрузка расписания
        function loadSchedule() {
            const scheduleData = JSON.parse(localStorage.getItem('scheduleData') || '[]');
            const scheduleTable = document.getElementById('schedule-table-body');
            
            if (scheduleTable) {
                scheduleTable.innerHTML = scheduleData.map(item => `
                    <tr>
                        <td>${item.id}</td>
                        <td>${item.class}</td>
                        <td>${item.day}</td>
                        <td>${item.time}</td>
                        <td>${item.subject}</td>
                        <td>${item.teacher}</td>
                        <td>${item.room}</td>
                        <td>
                            <button class="MuiButton-root MuiButton-outlined" onclick="editScheduleItem('${item.id}')">
                                <i class="material-icons" style="font-size: 1rem; vertical-align: middle;">edit</i>
                            </button>
                            <button class="MuiButton-root MuiButton-outlined" style="color: #f44336; border-color: #f44336;" onclick="deleteScheduleItem('${item.id}')">
                                <i class="material-icons" style="font-size: 1rem; vertical-align: middle;">delete</i>
                            </button>
                        </td>
                    </tr>
                `).join('');
            }
            
            // Обновляем селекторы
            updateScheduleSelectors();
        }

        // Загрузка настроек
        function loadSettings() {
            const settings = JSON.parse(localStorage.getItem('systemSettings') || '{}');
            
            // Устанавливаем значения toggle switches
            document.getElementById('registration-toggle').classList.toggle('active', settings.registration);
            document.getElementById('email-notifications-toggle').classList.toggle('active', settings.emailNotifications);
            document.getElementById('backup-toggle').classList.toggle('active', settings.backup);
            
            // Устанавливаем значения полей
            document.getElementById('min-grade').value = settings.minGrade || 2;
            document.getElementById('max-grade').value = settings.maxGrade || 5;
            document.getElementById('school-start-time').value = settings.schoolStartTime || '08:30';
            document.getElementById('school-end-time').value = settings.schoolEndTime || '15:00';
            document.getElementById('lesson-duration').value = settings.lessonDuration || 45;
        }

        // Обновление селекторов классов
        function updateClassSelectors() {
            const classesData = JSON.parse(localStorage.getItem('classesData') || '[]');
            const classSelectors = ['user-class', 'schedule-class', 'class-teacher'];
            
            classSelectors.forEach(selectorId => {
                const selector = document.getElementById(selectorId);
                if (selector) {
                    const currentValue = selector.value;
                    selector.innerHTML = '<option value="">Выберите класс</option>' +
                        classesData.map(cls => `<option value="${cls.name}">${cls.name}</option>`).join('');
                    selector.value = currentValue;
                }
            });
        }

        // Обновление селекторов расписания
        function updateScheduleSelectors() {
            const usersData = JSON.parse(localStorage.getItem('usersData') || '{}');
            const teacherSelectors = ['schedule-teacher', 'class-teacher'];
            
            teacherSelectors.forEach(selectorId => {
                const selector = document.getElementById(selectorId);
                if (selector && usersData.teachers) {
                    const currentValue = selector.value;
                    selector.innerHTML = '<option value="">Выберите учителя</option>' +
                        usersData.teachers.map(teacher => 
                            `<option value="${teacher.lastName} ${teacher.firstName}">${teacher.lastName} ${teacher.firstName}</option>`
                        ).join('');
                    selector.value = currentValue;
                }
            });
        }

        // Глобальные функции для управления
        window.addUser = function() {
            const activeTab = document.querySelector('.MuiTab-root.Mui-selected').getAttribute('data-tab');
            const firstName = document.getElementById('user-firstname').value;
            const lastName = document.getElementById('user-lastname').value;
            const email = document.getElementById('user-email').value;
            const phone = document.getElementById('user-phone').value;
            
            if (!firstName || !lastName || !email) {
                alert('Пожалуйста, заполните обязательные поля: Имя, Фамилия, Email');
                return;
            }
            
            const usersData = JSON.parse(localStorage.getItem('usersData') || '{}');
            const newUser = {
                id: activeTab + Date.now(),
                firstName,
                lastName,
                email,
                phone
            };
            
            if (activeTab === 'students') {
                newUser.class = document.getElementById('user-class').value;
            } else if (activeTab === 'teachers') {
                newUser.subjects = document.getElementById('user-subjects').value;
            } else if (activeTab === 'parents') {
                newUser.children = 'Не указано';
            } else if (activeTab === 'admins') {
                newUser.role = 'Администратор';
            }
            
            if (!usersData[activeTab]) {
                usersData[activeTab] = [];
            }
            
            usersData[activeTab].push(newUser);
            localStorage.setItem('usersData', JSON.stringify(usersData));
            
            // Очищаем форму
            document.getElementById('user-firstname').value = '';
            document.getElementById('user-lastname').value = '';
            document.getElementById('user-email').value = '';
            document.getElementById('user-phone').value = '';
            document.getElementById('user-class').value = '';
            document.getElementById('user-subjects').value = '';
            
            // Перезагружаем данные
            loadUsers();
            loadStatistics();
            
            alert('Пользователь успешно добавлен!');
        };

        window.addClass = function() {
            const name = document.getElementById('class-name').value;
            const teacher = document.getElementById('class-teacher').value;
            const room = document.getElementById('class-room').value;
            
            if (!name || !teacher || !room) {
                alert('Пожалуйста, заполните все поля');
                return;
            }
            
            const classesData = JSON.parse(localStorage.getItem('classesData') || '[]');
            const newClass = {
                id: 'class' + Date.now(),
                name,
                teacher,
                room,
                students: 0
            };
            
            classesData.push(newClass);
            localStorage.setItem('classesData', JSON.stringify(classesData));
            
            // Очищаем форму
            document.getElementById('class-name').value = '';
            document.getElementById('class-teacher').value = '';
            document.getElementById('class-room').value = '';
            
            // Перезагружаем данные
            loadClasses();
            loadStatistics();
            
            alert('Класс успешно добавлен!');
        };

        window.addScheduleItem = function() {
            const classValue = document.getElementById('schedule-class').value;
            const day = document.getElementById('schedule-day').value;
            const time = document.getElementById('schedule-time').value;
            const subject = document.getElementById('schedule-subject').value;
            const teacher = document.getElementById('schedule-teacher').value;
            const room = document.getElementById('schedule-room').value;
            
            if (!classValue || !day || !time || !subject || !teacher || !room) {
                alert('Пожалуйста, заполните все поля');
                return;
            }
            
            const scheduleData = JSON.parse(localStorage.getItem('scheduleData') || '[]');
            const newScheduleItem = {
                id: 'schedule' + Date.now(),
                class: classValue,
                day,
                time,
                subject,
                teacher,
                room
            };
            
            scheduleData.push(newScheduleItem);
            localStorage.setItem('scheduleData', JSON.stringify(scheduleData));
            
            // Очищаем форму
            document.getElementById('schedule-class').value = '';
            document.getElementById('schedule-day').value = '';
            document.getElementById('schedule-time').value = '';
            document.getElementById('schedule-subject').value = '';
            document.getElementById('schedule-teacher').value = '';
            document.getElementById('schedule-room').value = '';
            
            // Перезагружаем данные
            loadSchedule();
            
            alert('Элемент расписания успешно добавлен!');
        };

        window.toggleSetting = function(settingId) {
            const toggle = document.getElementById(settingId + '-toggle');
            toggle.classList.toggle('active');
        };

        window.saveSettings = function() {
            const settings = {
                registration: document.getElementById('registration-toggle').classList.contains('active'),
                emailNotifications: document.getElementById('email-notifications-toggle').classList.contains('active'),
                backup: document.getElementById('backup-toggle').classList.contains('active'),
                minGrade: parseInt(document.getElementById('min-grade').value),
                maxGrade: parseInt(document.getElementById('max-grade').value),
                schoolStartTime: document.getElementById('school-start-time').value,
                schoolEndTime: document.getElementById('school-end-time').value,
                lessonDuration: parseInt(document.getElementById('lesson-duration').value)
            };
            
            localStorage.setItem('systemSettings', JSON.stringify(settings));
            alert('Настройки успешно сохранены!');
        };

        window.editUser = function(type, userId) {
            alert(`Редактирование пользователя ${type} с ID: ${userId}`);
        };

        window.deleteUser = function(type, userId) {
            if (confirm('Вы уверены, что хотите удалить этого пользователя?')) {
                const usersData = JSON.parse(localStorage.getItem('usersData') || '{}');
                if (usersData[type]) {
                    usersData[type] = usersData[type].filter(user => user.id !== userId);
                    localStorage.setItem('usersData', JSON.stringify(usersData));
                    loadUsers();
                    loadStatistics();
                    alert('Пользователь успешно удален!');
                }
            }
        };

        window.editClass = function(classId) {
            alert(`Редактирование класса с ID: ${classId}`);
        };

        window.deleteClass = function(classId) {
            if (confirm('Вы уверены, что хотите удалить этот класс?')) {
                const classesData = JSON.parse(localStorage.getItem('classesData') || '[]');
                const updatedClasses = classesData.filter(cls => cls.id !== classId);
                localStorage.setItem('classesData', JSON.stringify(updatedClasses));
                loadClasses();
                loadStatistics();
                alert('Класс успешно удален!');
            }
        };

        window.editScheduleItem = function(scheduleId) {
            alert(`Редактирование элемента расписания с ID: ${scheduleId}`);
        };

        window.deleteScheduleItem = function(scheduleId) {
            if (confirm('Вы уверены, что хотите удалить этот элемент расписания?')) {
                const scheduleData = JSON.parse(localStorage.getItem('scheduleData') || '[]');
                const updatedSchedule = scheduleData.filter(item => item.id !== scheduleId);
                localStorage.setItem('scheduleData', JSON.stringify(updatedSchedule));
                loadSchedule();
                alert('Элемент расписания успешно удален!');
            }
        };

        function logout() {
            localStorage.removeItem('adminId');
            window.location.href = 'index.html';
        }
    </script>
</body>
</html>
